#程序设计 #软件工程与计算 #OOP #python 

> PPT: [[../钮老师课件/10 - 2 编程进阶-多态.pdf|10 - 2 编程进阶-多态]]

多态是指一个实体可以有多种不同的形式

三种形态: 

- 特设多态
- 参数多态
- 子类型多态

# 特设多态

- 特设多态 （Ad hoc polymorphism） 指一个多态函数（polymorphism functions）可以应 用于有不同类型的实际参数上 
- 以来它们所应用到的实际参数类型而有不同的表现。 
- 也称为函数重载（Function Overloading）或运算符 重载（Operator Overloading）

Example: 函数重载

```java
double sum(double a, double b){
	return a + b;
}

int sum(int a, int b){
	return a + b;
}
```

```cpp
<template T>
T sum(T a, T b){
	return a + b;
}
```

> 编译时就已经确定好了具体的函数

Python是动态类型语言，函数调用时，类型推迟到运行时判断，不支持通常的函数重载。

**在python中实现函数重载**:

- 通过实现一个检测类型的表, 可以使python支持这样的重载, 详见 [[../SICP/2. 构造数据抽象#2.5 带有通用型操作的系统|SICP第二章]]
- 使用 `@dispatch` 修饰符

```python
@dispatch(int, int)
def product(a, b):
	return a * b

@dispatch(float, float):
def product(a, b):
	return a * b
```

**在python中实现运算符重载**

```python
class Vector:
	def __init__(self, x, y):
		self._x = x
		self._y = y

	# 特殊方法 __add__ , 可实现加法的重载
	def __add__(self, other):
		return Vector(self._x + other._x, self._y + other._y)

	def __repr__(self):
		return '{0}, {1}'.format(self._x, self._y)
```

# 参数多态

参数多态允许函数或数据类型被一般性的书写，从而它 可以“统一”的处理值而不用依赖于它们的类型

这种函数和数据类型被分别称为“泛化函数” （generic functions）和“泛化数据类型”（generic datatypes）, 从 而形成了泛型编程（generic programming）的基础

Example: 泛化函数和泛化数据

python: duck typing, 不关心具体类型, 只关注当前方法和属性的集合

如python内置函数 `len()` , 调用了对象的 `__len__()` 方法

# 子类型多态

子类型和夫类型的一种可替换关系

即父类型的所有函数调用，可以 被子类型的函数完全替换

## 特殊方法

`__str__()` 返回一个对象的可读字符串形式

`print()` 会先调用 `__str__()` , 若没有, 则调用 `__repr__()`

`str()` 会调用 `__str__()`

当repr(obj)函数被调用时 :'

- Python 调用 ClassName.__repr__ 方法（如果存在） 
- 如果找不到，会在父类上找相应的__repr__ 
- 如果都失败了，调用object.__repr__