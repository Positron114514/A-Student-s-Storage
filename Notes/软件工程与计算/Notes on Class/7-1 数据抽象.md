#软件工程与计算 #python #程序设计 

> SICP对应章节: [[../SICP/2. 构造数据抽象|2. 构造数据抽象]]

需要把数据粘合起来形成抽象数据

将数据的表示和处理分离

# 1. 有理数

`Constructor` : 根据数据构造出抽象数据

`Selectors` : 根据抽象数据得到对应的数据

```python
from math import gcd

def rational(n, d):
	num = gcd(n, d)
	return [n // num, d // num]

def numer(x):
	return x[0]

def denom(x):
	return x[1]

def mul_rational(r_1, r_2):
	return rational(numer(r_1) * numer(r_2), denom(r_1) * denom(r_2))

def add_rational(r1, r2):
	return rational(numer(r1) * denom(r2) + numer(r2) * denom(r1), denom(r1) * denom(r2))

def print_rational(r):
	print(numer(r) + '/' + denom(r))
```

# 2. 抽象界限

**上层抽象不要使用下层抽象**

如上面的有理数例子, 有理数操作就尽量不要使用有理数实现的操作, 否则如果下层实现更改上层就无法使用

![[../../00 Resource/res/Pasted image 20240408092027.png]]

用函数实现: 

```python
def rational(n, d):
	num = gcd(n, d)
	n, d = n // num, d // num
	
	def select(msg):
		if msg == 'n':
			return n
		elif msg == 'd':
			return d
		else:
			print("Invalid input")
	
	return select

def numer(x):
	return x('n')

def denom(x):
	return x('d')
```

